(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{K1o8:function(e,t,i){"use strict";i.r(t),i.d(t,"ROUTES",function(){return I}),i.d(t,"FeaturesModule",function(){return E});var r=i("tyNb"),n=i("KZX/"),s=i("mrSG"),c=i("9FRo"),o=i("fXoL"),a=i("nN8Z"),d=i("wSIx");let u=(()=>{class e{constructor(){this.edit=new o.o,this.refresh=new o.o,this.active=new o.o,this.tableName="Feature Table",this.columns=[{key:"_id",type:"image",content:e=>({classname:"table_image",text:"Edit",url:this.imageUrl+`${e._id}`,event:{key:"img",id:e._id}})},{path:"name",label:"Name",searchable:!0},{path:"priority",label:"Priority"},{path:"active",label:"Active"},{key:"_id",type:"button",content:e=>({classname:"edit_link",text:"Select",link:"#",event:{key:"edit",id:e._id}})}],this.sortColumn={path:"name",order:"asc",limit:8,page:1,search:""},this.pushCol=0}ngOnChanges(e){this.canActivate&&!this.pushCol&&(this.columns.push({key:"_id",type:"button",content:e=>({classname:"edit_link",text:(null==e?void 0:e.active)?"Deactivate":"Activate",link:"#",event:{key:"active",id:e._id}})}),this.pushCol=1)}buttonEvent(e){switch(e.key){case"edit":this.edit.emit(e.id);break;case"active":this.active.emit(e.id)}}onRefresh(e){this.sortColumn=Object.assign({},e),this.refresh.emit(Object.assign({sort:e.path},e))}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=o.Ib({type:e,selectors:[["app-feature-table"]],inputs:{featurePage:"featurePage",imageUrl:"imageUrl",canActivate:"canActivate"},outputs:{edit:"edit",refresh:"refresh",active:"active"},features:[o.yb],decls:1,vars:4,consts:[[3,"tableName","columns","sortColumn","data","refresh","btnEvent"]],template:function(e,t){1&e&&(o.Tb(0,"ng-table",0),o.dc("refresh",function(e){return t.onRefresh(e)})("btnEvent",function(e){return t.buttonEvent(e)}),o.Sb()),2&e&&o.mc("tableName",t.tableName)("columns",t.columns)("sortColumn",t.sortColumn)("data",t.featurePage)},directives:[d.a],styles:[""]}),e})();var b=i("3Pt+"),f=i("I/JT"),l=i("ofXK"),h=i("gpvV"),m=i("xS1Y"),g=i("/ZIw");function p(e,t){if(1&e&&(o.Rb(0),o.Tb(1,"p",12),o.Ec(2),o.Sb(),o.Qb()),2&e){const e=o.fc();o.Ab(2),o.Fc(e.err)}}function v(e,t){if(1&e){const e=o.Ub();o.Tb(0,"button",10),o.dc("click",function(){return o.xc(e),o.fc().onDelete()}),o.Ec(1,"Delete"),o.Sb()}}function S(e,t){if(1&e&&(o.Tb(0,"div",13),o.Pb(1,"form-validator",14),o.Sb()),2&e){const e=o.fc();o.Ab(1),o.mc("form",e.form)}}let y=(()=>{class e extends f.a{constructor(e){super(),this.fb=e,this.createForm()}createForm(){this.form=this.fb.group({name:["",b.t.required],priority:["",b.t.required],images:[null]})}onError(e){this.err=e}}return e.\u0275fac=function(t){return new(t||e)(o.Ob(b.c))},e.\u0275cmp=o.Ib({type:e,selectors:[["app-feature-form"]],features:[o.xb],decls:15,vars:15,consts:[[1,"form-head"],[4,"ngIf"],[1,"p-3",3,"formGroup","ngSubmit","mouseleave"],[3,"fieldId","control"],[3,"fieldId","control","type"],[3,"fieldId","form","hints","err"],[1,"d-flex","flex-row-reverse","bd-highlight"],[3,"mouseenter"],["type","submit",1,"btn","btn-sm","btn-light","mx-1",3,"disabled"],["type","button","class","btn btn-sm btn-light mx-1",3,"click",4,"ngIf"],["type","button",1,"btn","btn-sm","btn-light","mx-1",3,"click"],["class","text-danger",4,"ngIf"],[1,"px-4","text-center","text-danger"],[1,"text-danger"],[3,"form"]],template:function(e,t){1&e&&(o.Tb(0,"div",0),o.Ec(1),o.Sb(),o.Cc(2,p,3,1,"ng-container",1),o.Tb(3,"form",2),o.dc("ngSubmit",function(){return t.submit()})("mouseleave",function(){return t.mouseoverShifting=!1}),o.Pb(4,"form-input",3),o.Pb(5,"form-input",4),o.Tb(6,"form-file",5),o.dc("err",function(e){return t.onError(e)}),o.Sb(),o.Tb(7,"div",6),o.Tb(8,"span",7),o.dc("mouseenter",function(){return t.mouseoverShifting=!0}),o.Tb(9,"button",8),o.Ec(10),o.Sb(),o.Sb(),o.Cc(11,v,2,0,"button",9),o.Tb(12,"button",10),o.dc("click",function(){return t.clean()}),o.Ec(13,"Clear"),o.Sb(),o.Sb(),o.Cc(14,S,2,1,"div",11),o.Sb()),2&e&&(o.Ab(1),o.Gc(" ",t.exists?"Update":"New"," Feature\n"),o.Ab(1),o.mc("ngIf",t.err.length>0),o.Ab(1),o.mc("formGroup",t.form),o.Ab(1),o.mc("fieldId","name")("control",t.form.get("name")),o.Ab(1),o.mc("fieldId","priority")("control",t.form.get("priority"))("type","number"),o.Ab(1),o.mc("fieldId","images")("form",t.form)("hints","Preferred image size is 1024x400 px"),o.Ab(3),o.mc("disabled",!t.form.valid),o.Ab(1),o.Fc(t.exists?"Update":"Save"),o.Ab(1),o.mc("ngIf",t.exists),o.Ab(3),o.mc("ngIf",t.mouseoverShifting))},directives:[l.o,b.v,b.m,b.f,h.a,m.a,g.a],styles:[""]}),e})(),P=(()=>{class e{constructor(e){this.service=e,this.loading=!1,this.errMsg="",this.imageUrl=this.service.imageLink+"/image/"}ngOnInit(){this.getList(new c.a)}getList(e){return Object(s.a)(this,void 0,void 0,function*(){try{this.loading=!0,this.featurePage=yield this.service.getList(e).toPromise(),this.loading=!1}catch(t){this.errMsg=t.message}})}refreshData({page:e,limit:t,sort:i,order:r,search:n}){this.getList(new c.a(e,t,i,r,n))}onEdit(e){const t=this.featurePage.docs.find(t=>t._id===e);this.feature=Object.assign({},t)}onCreate(e){return Object(s.a)(this,void 0,void 0,function*(){try{this.loading=!0;const t=yield this.service.create(e).toPromise();this.featurePage.docs.push(t),this.clear()}catch(t){}})}onUpdate(e){return Object(s.a)(this,void 0,void 0,function*(){try{this.loading=!0,yield this.service.update(this.feature._id,e).toPromise(),this.getList(new c.a),this.clear()}catch(t){this.errMsg=t.message}})}onDelete(e){return Object(s.a)(this,void 0,void 0,function*(){if(confirm("Are you sure to delete")){try{this.loading=!0,yield this.service.delete(e).toPromise();const t=this.featurePage.docs.findIndex(t=>t._id===e);t>-1&&this.featurePage.docs.splice(t,1),this.clear()}catch(t){this.errMsg=t.message}this.clear()}})}onActive(e){return Object(s.a)(this,void 0,void 0,function*(){try{this.loading=!0;const t=yield this.service.activate(e).toPromise(),i=this.featurePage.docs.findIndex(t=>t._id===e);this.featurePage.docs.splice(i,1,t),this.loading=!1}catch(t){}})}clear(){this.feature=null,this.errMsg="",this.loading=!1}}return e.\u0275fac=function(t){return new(t||e)(o.Ob(a.a))},e.\u0275cmp=o.Ib({type:e,selectors:[["app-index"]],decls:10,vars:5,consts:[[1,"container-fluid","component-head"],[1,"container"],[1,"row"],[1,"col-md-8"],[3,"featurePage","imageUrl","canActivate","edit","refresh","active"],[1,"col-md-4"],[1,"border","rounded","bg-white"],[3,"item","err","create","update","delete"]],template:function(e,t){1&e&&(o.Tb(0,"div",0),o.Tb(1,"h3"),o.Ec(2,"Features"),o.Sb(),o.Sb(),o.Tb(3,"div",1),o.Tb(4,"div",2),o.Tb(5,"div",3),o.Tb(6,"app-feature-table",4),o.dc("edit",function(e){return t.onEdit(e)})("refresh",function(e){return t.refreshData(e)})("active",function(e){return t.onActive(e)}),o.Sb(),o.Sb(),o.Tb(7,"div",5),o.Tb(8,"div",6),o.Tb(9,"app-feature-form",7),o.dc("create",function(e){return t.onCreate(e)})("update",function(e){return t.onUpdate(e)})("delete",function(e){return t.onDelete(e)}),o.Sb(),o.Sb(),o.Sb(),o.Sb(),o.Sb()),2&e&&(o.Ab(6),o.mc("featurePage",t.featurePage)("imageUrl",t.imageUrl)("canActivate",!0),o.Ab(3),o.mc("item",t.feature)("err",t.errMsg))},directives:[u,y],styles:["[_nghost-%COMP%]{font-size:14px;font-family:Montserrat,sans-serif;display:block;position:relative;min-height:calc(100% - 57px);background-color:#f2f4f5}"]}),e})();var T=i("wOd6"),x=i("MYE5");function A(e,t){if(1&e){const e=o.Ub();o.Tb(0,"div",5),o.Tb(1,"app-feature-table",6),o.dc("edit",function(t){return o.xc(e),o.fc().onEdit(t)})("refresh",function(t){return o.xc(e),o.fc().refreshData(t)}),o.Sb(),o.Sb()}if(2&e){const e=o.fc();o.Ab(1),o.mc("featurePage",e.featurePage)("imageUrl",e.imageUrl)}}function w(e,t){if(1&e){const e=o.Ub();o.Tb(0,"tr"),o.Tb(1,"td"),o.Pb(2,"img",17),o.Sb(),o.Tb(3,"td"),o.Ec(4),o.Sb(),o.Tb(5,"td"),o.Ec(6),o.Sb(),o.Tb(7,"td",13),o.Tb(8,"button",16),o.dc("click",function(){o.xc(e);const i=t.$implicit;return o.fc(2).onRemoveProduct(i._id)}),o.Pb(9,"i",18),o.Sb(),o.Sb(),o.Sb()}if(2&e){const e=t.$implicit,i=o.fc(2);o.Ab(2),o.mc("src",i.thumbUrl+e._id,o.zc),o.Ab(2),o.Fc(e.name),o.Ab(2),o.Fc(e.size)}}function k(e,t){if(1&e){const e=o.Ub();o.Rb(0),o.Tb(1,"div",7),o.Tb(2,"product-table",8),o.dc("edit",function(t){return o.xc(e),o.fc().onAddProduct(t)})("refresh",function(t){return o.xc(e),o.fc().refreshProductData(t)}),o.Sb(),o.Sb(),o.Tb(3,"div",9),o.Tb(4,"table",10),o.Tb(5,"thead"),o.Tb(6,"tr"),o.Tb(7,"td",11),o.Tb(8,"div",12),o.Tb(9,"div"),o.Ec(10),o.Sb(),o.Sb(),o.Sb(),o.Sb(),o.Tb(11,"tr"),o.Pb(12,"th"),o.Tb(13,"th"),o.Ec(14,"Name"),o.Sb(),o.Tb(15,"th"),o.Ec(16,"Size"),o.Sb(),o.Tb(17,"th",13),o.Ec(18,"Remove"),o.Sb(),o.Sb(),o.Sb(),o.Tb(19,"tbody"),o.Cc(20,w,10,3,"tr",14),o.Sb(),o.Sb(),o.Sb(),o.Tb(21,"div",15),o.Tb(22,"button",16),o.dc("click",function(){return o.xc(e),o.fc().onClose()}),o.Ec(23,"Close"),o.Sb(),o.Sb(),o.Qb()}if(2&e){const e=o.fc();o.Ab(2),o.mc("productPage",e.productPage)("thumbUrl",e.thumbUrl)("small",!0),o.Ab(8),o.Gc("",null==e.feature?null:e.feature.name," product list"),o.Ab(10),o.mc("ngForOf",e.feature.products)}}const I=[{path:"products",component:(()=>{class e{constructor(e,t){this.service=e,this.productService=t,this.loading=!1,this.errMsg="",this.imageUrl=this.service.imageLink+"/image/",this.thumbUrl=this.productService.imageLink+"/thumb/"}ngOnInit(){this.getList(new c.a),this.getProductList(new c.a)}getList(e){return Object(s.a)(this,void 0,void 0,function*(){try{this.loading=!0,this.featurePage=yield this.service.getList(e).toPromise(),this.loading=!1}catch(t){this.errMsg=t.message}})}refreshData({page:e,limit:t,sort:i,order:r,search:n}){this.getList(new c.a(e,t,i,r,n))}onEdit(e){const t=this.featurePage.docs.find(t=>t._id===e);this.feature=Object.assign({},t)}getProductList(e){return Object(s.a)(this,void 0,void 0,function*(){try{this.loading=!0,this.productPage=yield this.productService.getList(e).toPromise(),this.loading=!1}catch(t){this.errMsg=t.message}})}refreshProductData({page:e,limit:t,sort:i,order:r,search:n}){this.getProductList(new c.a(e,t,i,r,n))}onAddProduct(e){return Object(s.a)(this,void 0,void 0,function*(){try{this.loading=!0;const t=yield this.service.add(this.feature._id,e).toPromise();this.updateFeaturPage(t)}catch(t){this.errMsg=t.message}})}onRemoveProduct(e){return Object(s.a)(this,void 0,void 0,function*(){try{this.loading=!0;const t=yield this.service.remove(this.feature._id,e).toPromise();this.updateFeaturPage(t)}catch(t){this.errMsg=t.message}})}updateFeaturPage(e){this.feature=e;const t=this.featurePage.docs.findIndex(t=>t._id===e._id);t>=0&&this.featurePage.docs.splice(t,1,e),this.loading=!1}onClose(){this.feature=null}}return e.\u0275fac=function(t){return new(t||e)(o.Ob(a.a),o.Ob(T.a))},e.\u0275cmp=o.Ib({type:e,selectors:[["app-featured-products"]],decls:7,vars:2,consts:[[1,"container-fluid","component-head"],[1,"container"],[1,"row"],["class","col-md-8",4,"ngIf"],[4,"ngIf"],[1,"col-md-8"],[3,"featurePage","imageUrl","edit","refresh"],[1,"col-md-6","bg-white"],[3,"productPage","thumbUrl","small","edit","refresh"],[1,"col-md-6"],[1,"table","table-hover","table-bordered","table-responsive-sm","bg-white"],["colspan","4",1,"form-head"],[1,"d-flex","justify-content-between"],[1,"text-right"],[4,"ngFor","ngForOf"],[1,"col-12","d-flex","flex-row-reverse"],[1,"btn","btn-sm","btn-danger",3,"click"],["_ngcontent-smn-c121","",1,"table_image",3,"src"],[1,"fa","fa-trash-o"]],template:function(e,t){1&e&&(o.Tb(0,"div",0),o.Tb(1,"h3"),o.Ec(2,"Features"),o.Sb(),o.Sb(),o.Tb(3,"div",1),o.Tb(4,"div",2),o.Cc(5,A,2,2,"div",3),o.Cc(6,k,24,5,"ng-container",4),o.Sb(),o.Sb()),2&e&&(o.Ab(5),o.mc("ngIf",!t.feature),o.Ab(1),o.mc("ngIf",t.feature))},directives:[l.o,u,x.a,l.n],styles:["[_nghost-%COMP%]{font-size:14px;font-family:Montserrat,sans-serif;display:block;position:relative;min-height:calc(100% - 57px);background-color:#f2f4f5}"]}),e})()},{path:"",component:P}];let E=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=o.Mb({type:e}),e.\u0275inj=o.Lb({imports:[[n.a,r.d.forChild(I)]]}),e})()}}]);