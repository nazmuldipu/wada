(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{T9yq:function(t,e,r){"use strict";r.r(e),r.d(e,"ROUTES",function(){return rt}),r.d(e,"OrdersModule",function(){return ot});var o=r("tyNb"),n=r("KZX/"),c=r("mrSG"),i=r("msxj"),a=r("fXoL"),s=r("Si13"),b=r("9FRo"),l=r("ofXK"),d=r("3Pt+"),u=r("uEz7");function m(t,e){if(1&t&&(a.Tb(0,"option",15),a.Ec(1),a.Sb()),2&t){const t=e.$implicit;a.mc("value",t.name),a.Ab(1),a.Fc(t.text)}}function p(t,e){if(1&t&&(a.Tb(0,"option",15),a.Ec(1),a.Sb()),2&t){const t=e.$implicit;a.mc("value",t.name),a.Ab(1),a.Fc(t.text)}}function f(t,e){if(1&t){const t=a.Ub();a.Tb(0,"li",6),a.Tb(1,"div",7),a.Tb(2,"div",8),a.Tb(3,"label",9),a.Ec(4,"Order Status"),a.Sb(),a.Tb(5,"select",10),a.dc("change",function(e){return a.xc(t),a.fc().onOrderStatusSelect(e.target.value)}),a.Tb(6,"option",11),a.Ec(7,"All"),a.Sb(),a.Cc(8,m,2,2,"option",12),a.Sb(),a.Sb(),a.Tb(9,"div",8),a.Tb(10,"label",13),a.Ec(11,"Payment Methods"),a.Sb(),a.Tb(12,"select",14),a.dc("change",function(e){return a.xc(t),a.fc().onPaymentMethodSelect(e.target.value)}),a.Tb(13,"option",11),a.Ec(14,"All"),a.Sb(),a.Cc(15,p,2,2,"option",12),a.Sb(),a.Sb(),a.Sb(),a.Sb()}if(2&t){const t=a.fc();a.Ab(8),a.mc("ngForOf",t.orderStatusData),a.Ab(7),a.mc("ngForOf",t.paymentMethodsData)}}function g(t,e){if(1&t){const t=a.Ub();a.Tb(0,"li",16),a.dc("click",function(){a.xc(t);const r=e.$implicit;return a.fc().onSelectOrder(r)}),a.Tb(1,"div",17),a.Tb(2,"div",18),a.Tb(3,"div"),a.Ec(4),a.Sb(),a.Tb(5,"div",19),a.Ec(6),a.Sb(),a.Tb(7,"div",20),a.Ec(8),a.Sb(),a.Tb(9,"div",21),a.Ec(10),a.Sb(),a.Sb(),a.Tb(11,"div",22),a.Tb(12,"div"),a.Tb(13,"small"),a.Ec(14),a.gc(15,"date"),a.Sb(),a.Sb(),a.Tb(16,"div"),a.Ec(17),a.Sb(),a.Sb(),a.Sb(),a.Sb()}if(2&t){const t=e.$implicit;a.Ab(4),a.Gc(" Order # ",t.orderNumber," "),a.Ab(2),a.Fc(t.paymentStatus),a.Ab(2),a.Fc(t.orderStatus),a.Ab(2),a.Fc(t.paymentMethod),a.Ab(4),a.Gc(" ",a.ic(15,6,t.createdAt,"short"),""),a.Ab(3),a.Gc("Total : ",t.total,"")}}function h(t,e){if(1&t){const t=a.Ub();a.Tb(0,"pagination",23),a.dc("pageChange",function(e){return a.xc(t),a.fc().refreshOrderData(e)}),a.Sb()}if(2&t){const t=a.fc();a.mc("page",t.orderPage.page)("collectionSize",t.orderPage.totalDocs)("pageSize",t.orderPage.limit)("short",!0)}}let S=(()=>{class t{constructor(t){this.service=t,this.pick=new a.o,this.loading=!1,this.filter=!1,this.errMsg=""}ngOnInit(){this.paymentMethodsData=i.e,this.orderStatusData=i.d,this.pagi=new b.a(1,8,"orderNumber","desc",""),this.getOrders(this.pagi)}getOrders(t){return Object(c.a)(this,void 0,void 0,function*(){try{this.loading=!0,this.orderPage=yield this.service.getOrderList(t).toPromise(),this.loading=!1}catch(e){this.errMsg=e.message}})}refreshOrderData(t){this.pagi.page=t,this.updateOrders()}onPaymentMethodSelect(t){this.pagi.page=1,this.paymentMethodParam=""===t?null:"paymentMethod="+t,this.updateOrders()}onOrderStatusSelect(t){this.pagi.page=1,this.orderStatusParam=""===t?null:"orderStatus="+t,this.updateOrders()}updateOrders(){this.pagi.param=(this.paymentMethodParam?this.paymentMethodParam:"")+(this.paymentMethodParam&&this.orderStatusParam?"&":"")+(this.orderStatusParam?this.orderStatusParam:""),this.getOrders(this.pagi)}onSelectOrder(t){this.pick.emit(t)}onShowFilter(){this.filter=!this.filter}}return t.\u0275fac=function(e){return new(e||t)(a.Ob(s.a))},t.\u0275cmp=a.Ib({type:t,selectors:[["app-order-side-list"]],outputs:{pick:"pick"},decls:11,vars:4,consts:[[1,"list-group","mb-1"],[1,"list-group-item"],[3,"click"],["class","list-group-item p-1 px-2",4,"ngIf"],["class","list-group-item ordres",3,"click",4,"ngFor","ngForOf"],[3,"page","collectionSize","pageSize","short","pageChange",4,"ngIf"],[1,"list-group-item","p-1","px-2"],[1,"form-row"],[1,"form-group","col","m-0"],["for","orderStatus"],["id","orderStatus",1,"form-control","form-control-sm",3,"change"],["value",""],[3,"value",4,"ngFor","ngForOf"],["for","paymentMethods"],["id","paymentMethods",1,"form-control","form-control-sm",3,"change"],[3,"value"],[1,"list-group-item","ordres",3,"click"],[1,"row"],[1,"col"],[1,"badge","badge-primary","mx-1"],[1,"badge","badge-success","mx-1"],[1,"badge","badge-info","mx-1"],[1,"col-auto"],[3,"page","collectionSize","pageSize","short","pageChange"]],template:function(t,e){1&t&&(a.Tb(0,"ul",0),a.Tb(1,"li",1),a.Ec(2,"Please select a "),a.Tb(3,"strong"),a.Ec(4," Order "),a.Sb(),a.Ec(5," from list below "),a.Tb(6,"a",2),a.dc("click",function(){return e.onShowFilter()}),a.Ec(7),a.Sb(),a.Sb(),a.Cc(8,f,16,2,"li",3),a.Cc(9,g,18,9,"li",4),a.Sb(),a.Cc(10,h,1,4,"pagination",5)),2&t&&(a.Ab(7),a.Gc("",e.filter?"Hide":"Show"," filter"),a.Ab(1),a.mc("ngIf",e.filter),a.Ab(1),a.mc("ngForOf",null==e.orderPage?null:e.orderPage.docs),a.Ab(1),a.mc("ngIf",(null==e.orderPage?null:e.orderPage.totalPages)>1))},directives:[l.o,l.n,d.p,d.u,u.a],pipes:[l.f],styles:[".ordres[_ngcontent-%COMP%]{font-size:14px;padding:5px}.ordres[_ngcontent-%COMP%]:hover{cursor:pointer;background-color:#ffc247}a[_ngcontent-%COMP%]{color:#00f!important;cursor:pointer}"]}),t})();var v=r("WcrV");function T(t,e){if(1&t&&(a.Tb(0,"option",20),a.Ec(1),a.Sb()),2&t){const t=e.$implicit;a.mc("value",t.name),a.Ab(1),a.Fc(t.text)}}function y(t,e){if(1&t&&(a.Tb(0,"option",20),a.Ec(1),a.Sb()),2&t){const t=e.$implicit;a.mc("value",t.name),a.Ab(1),a.Gc("",t.text," ")}}function O(t,e){if(1&t&&(a.Tb(0,"option",20),a.Ec(1),a.Sb()),2&t){const t=e.$implicit;a.mc("value",t.name),a.Ab(1),a.Gc("",t.text," ")}}function A(t,e){if(1&t){const t=a.Ub();a.Tb(0,"div",6),a.Pb(1,"app-order-details",7),a.Tb(2,"h5",8),a.Ec(3,"Update Order Status"),a.Sb(),a.Tb(4,"div",9),a.Tb(5,"div",10),a.Tb(6,"label",11),a.Ec(7,"Order Status"),a.Sb(),a.Tb(8,"select",12),a.dc("ngModelChange",function(e){return a.xc(t),a.fc().status.orderStatus=e}),a.Cc(9,T,2,2,"option",13),a.Sb(),a.Sb(),a.Tb(10,"div",10),a.Tb(11,"label",14),a.Ec(12,"Payment Methods"),a.Sb(),a.Tb(13,"select",15),a.dc("ngModelChange",function(e){return a.xc(t),a.fc().status.paymentMethod=e}),a.Cc(14,y,2,2,"option",13),a.Sb(),a.Sb(),a.Tb(15,"div",10),a.Tb(16,"label",16),a.Ec(17,"Payment Status"),a.Sb(),a.Tb(18,"select",17),a.dc("ngModelChange",function(e){return a.xc(t),a.fc().status.paymentStatus=e}),a.Cc(19,O,2,2,"option",13),a.Sb(),a.Sb(),a.Tb(20,"div",18),a.Tb(21,"button",19),a.dc("click",function(){return a.xc(t),a.fc().onUpdateStatus()}),a.Ec(22,"Update"),a.Sb(),a.Sb(),a.Sb(),a.Sb()}if(2&t){const t=a.fc();a.Ab(1),a.mc("order",t.order)("admin",!0),a.Ab(7),a.mc("ngModel",t.status.orderStatus),a.Ab(1),a.mc("ngForOf",t.orderStatusData),a.Ab(4),a.mc("ngModel",t.status.paymentMethod),a.Ab(1),a.mc("ngForOf",t.paymentMethodsData),a.Ab(4),a.mc("ngModel",t.status.paymentStatus),a.Ab(1),a.mc("ngForOf",t.paymentStatusData)}}let C=(()=>{class t{constructor(t){this.service=t}ngOnInit(){this.paymentMethodsData=i.e,this.orderStatusData=i.d,this.paymentStatusData=i.f}onDetails({_id:t}){return Object(c.a)(this,void 0,void 0,function*(){try{this.order=yield this.service.getOrder(t).toPromise(),this.order._id=t,this.status={orderStatus:this.order.orderStatus,paymentStatus:this.order.paymentStatus,paymentMethod:this.order.paymentMethod}}catch(e){console.log(e)}})}onUpdateStatus(){return Object(c.a)(this,void 0,void 0,function*(){console.log(this.status);try{this.order=yield this.service.updateStatus(this.order._id,this.status).toPromise()}catch(t){console.log(t)}})}}return t.\u0275fac=function(e){return new(e||t)(a.Ob(s.a))},t.\u0275cmp=a.Ib({type:t,selectors:[["app-index"]],decls:8,vars:1,consts:[[1,"container-fluid","component-head"],[1,"container-fluid"],[1,"row"],[1,"col-md-3"],[3,"pick"],["class","col-md-9",4,"ngIf"],[1,"col-md-9"],[3,"order","admin"],[1,"mt-3"],[1,"form-row","bg-white","m-1","p-2","mb-5","border"],[1,"form-group","col","m-0"],["for","orderStatus"],["id","orderStatus",1,"form-control","form-control-sm",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["for","paymentMethods"],["id","paymentMethods",1,"form-control","form-control-sm",3,"ngModel","ngModelChange"],["for","paymentStatus"],["id","paymentMethod",1,"form-control","form-control-sm",3,"ngModel","ngModelChange"],[1,"col-auto","d-flex","align-items-end"],[1,"btn","btn-sm","btn-primary",3,"click"],[3,"value"]],template:function(t,e){1&t&&(a.Tb(0,"div",0),a.Tb(1,"h3"),a.Ec(2,"Orders"),a.Sb(),a.Sb(),a.Tb(3,"div",1),a.Tb(4,"div",2),a.Tb(5,"div",3),a.Tb(6,"app-order-side-list",4),a.dc("pick",function(t){return e.onDetails(t)}),a.Sb(),a.Sb(),a.Cc(7,A,23,8,"div",5),a.Sb(),a.Sb()),2&t&&(a.Ab(7),a.mc("ngIf",e.order))},directives:[S,l.o,v.a,d.s,d.l,d.o,l.n,d.p,d.u],styles:["[_nghost-%COMP%]{font-size:14px;font-family:Montserrat,sans-serif;display:block;position:relative;min-height:calc(100% - 57px);background-color:#f2f4f5}"]}),t})();function M(t,e){if(1&t){const t=a.Ub();a.Tb(0,"li",8),a.dc("click",function(){a.xc(t);const r=e.$implicit;return a.fc().onSelectOrder(r)}),a.Tb(1,"div",9),a.Tb(2,"div",10),a.Tb(3,"div"),a.Ec(4),a.Sb(),a.Tb(5,"div",11),a.Ec(6),a.Sb(),a.Tb(7,"div",12),a.Ec(8),a.Sb(),a.Tb(9,"div",13),a.Ec(10),a.Sb(),a.Sb(),a.Tb(11,"div",14),a.Tb(12,"div"),a.Tb(13,"small"),a.Ec(14),a.gc(15,"date"),a.Sb(),a.Sb(),a.Tb(16,"div"),a.Ec(17),a.Sb(),a.Sb(),a.Sb(),a.Sb()}if(2&t){const t=e.$implicit;a.Ab(4),a.Gc(" Order # ",t.orderNumber," "),a.Ab(2),a.Fc(t.paymentStatus),a.Ab(2),a.Fc(t.orderStatus),a.Ab(2),a.Fc(t.paymentMethod),a.Ab(4),a.Gc(" ",a.ic(15,6,t.createdAt,"short"),""),a.Ab(3),a.Gc("Total : ",t.total,"")}}function P(t,e){if(1&t){const t=a.Ub();a.Tb(0,"pagination",15),a.dc("pageChange",function(e){return a.xc(t),a.fc().refreshOrderData(e)}),a.Sb()}if(2&t){const t=a.fc();a.mc("page",t.orderPage.page)("collectionSize",t.orderPage.totalDocs)("pageSize",t.orderPage.limit)("short",!0)}}let x=(()=>{class t{constructor(t){this.service=t,this.pick=new a.o,this.search="",this.loading=!1}ngOnInit(){this.pagi=new b.a(1,8,"orderNumber","desc","")}searchOrder(t){return Object(c.a)(this,void 0,void 0,function*(){try{this.loading=!0,this.orderPage=yield this.service.search(t).toPromise(),this.loading=!1}catch(e){}})}onSelectOrder(t){this.pick.emit(t)}}return t.\u0275fac=function(e){return new(e||t)(a.Ob(s.a))},t.\u0275cmp=a.Ib({type:t,selectors:[["app-order-side-search"]],outputs:{pick:"pick"},decls:12,vars:3,consts:[[1,"list-group","mb-1"],[1,"list-group-item"],[1,"list-group-item","p-2"],[3,"ngSubmit"],[1,"form-group","m-0"],["placeholder","OrderNumber / Name / Phone","name","search",1,"form-control","form-control-sm",3,"ngModel","ngModelChange"],["class","list-group-item ordres",3,"click",4,"ngFor","ngForOf"],[3,"page","collectionSize","pageSize","short","pageChange",4,"ngIf"],[1,"list-group-item","ordres",3,"click"],[1,"row"],[1,"col"],[1,"badge","badge-primary","mx-1"],[1,"badge","badge-success","mx-1"],[1,"badge","badge-info","mx-1"],[1,"col-auto"],[3,"page","collectionSize","pageSize","short","pageChange"]],template:function(t,e){1&t&&(a.Tb(0,"ul",0),a.Tb(1,"li",1),a.Ec(2," Please select a "),a.Tb(3,"strong"),a.Ec(4," Order "),a.Sb(),a.Ec(5," from list below "),a.Sb(),a.Tb(6,"li",2),a.Tb(7,"form",3),a.dc("ngSubmit",function(){return e.searchOrder(e.pagi)}),a.Tb(8,"div",4),a.Tb(9,"input",5),a.dc("ngModelChange",function(t){return e.pagi.param=t}),a.Sb(),a.Sb(),a.Sb(),a.Sb(),a.Cc(10,M,18,9,"li",6),a.Sb(),a.Cc(11,P,1,4,"pagination",7)),2&t&&(a.Ab(9),a.mc("ngModel",e.pagi.param),a.Ab(1),a.mc("ngForOf",null==e.orderPage?null:e.orderPage.docs),a.Ab(1),a.mc("ngIf",(null==e.orderPage?null:e.orderPage.totalPages)>1))},directives:[d.v,d.m,d.n,d.a,d.l,d.o,l.n,l.o,u.a],pipes:[l.f],styles:[".ordres[_ngcontent-%COMP%]{font-size:14px;padding:5px}.ordres[_ngcontent-%COMP%]:hover{cursor:pointer;background-color:#ffc247}a[_ngcontent-%COMP%]{color:#00f!important;cursor:pointer}"]}),t})();function E(t,e){if(1&t&&(a.Tb(0,"option",20),a.Ec(1),a.Sb()),2&t){const t=e.$implicit;a.mc("value",t.name),a.Ab(1),a.Fc(t.text)}}function I(t,e){if(1&t&&(a.Tb(0,"option",20),a.Ec(1),a.Sb()),2&t){const t=e.$implicit;a.mc("value",t.name),a.Ab(1),a.Gc("",t.text," ")}}function k(t,e){if(1&t&&(a.Tb(0,"option",20),a.Ec(1),a.Sb()),2&t){const t=e.$implicit;a.mc("value",t.name),a.Ab(1),a.Gc("",t.text," ")}}function F(t,e){if(1&t){const t=a.Ub();a.Tb(0,"div",6),a.Pb(1,"app-order-details",7),a.Tb(2,"h5",8),a.Ec(3,"Update Order Status"),a.Sb(),a.Tb(4,"div",9),a.Tb(5,"div",10),a.Tb(6,"label",11),a.Ec(7,"Order Status"),a.Sb(),a.Tb(8,"select",12),a.dc("ngModelChange",function(e){return a.xc(t),a.fc().status.orderStatus=e}),a.Cc(9,E,2,2,"option",13),a.Sb(),a.Sb(),a.Tb(10,"div",10),a.Tb(11,"label",14),a.Ec(12,"Payment Methods"),a.Sb(),a.Tb(13,"select",15),a.dc("ngModelChange",function(e){return a.xc(t),a.fc().status.paymentMethod=e}),a.Cc(14,I,2,2,"option",13),a.Sb(),a.Sb(),a.Tb(15,"div",10),a.Tb(16,"label",16),a.Ec(17,"Payment Status"),a.Sb(),a.Tb(18,"select",17),a.dc("ngModelChange",function(e){return a.xc(t),a.fc().status.paymentStatus=e}),a.Cc(19,k,2,2,"option",13),a.Sb(),a.Sb(),a.Tb(20,"div",18),a.Tb(21,"button",19),a.dc("click",function(){return a.xc(t),a.fc().onUpdateStatus()}),a.Ec(22,"Update"),a.Sb(),a.Sb(),a.Sb(),a.Sb()}if(2&t){const t=a.fc();a.Ab(1),a.mc("order",t.order)("admin",!0),a.Ab(7),a.mc("ngModel",t.status.orderStatus),a.Ab(1),a.mc("ngForOf",t.orderStatusData),a.Ab(4),a.mc("ngModel",t.status.paymentMethod),a.Ab(1),a.mc("ngForOf",t.paymentMethodsData),a.Ab(4),a.mc("ngModel",t.status.paymentStatus),a.Ab(1),a.mc("ngForOf",t.paymentStatusData)}}let w=(()=>{class t{constructor(t){this.service=t}ngOnInit(){this.paymentMethodsData=i.e,this.orderStatusData=i.d,this.paymentStatusData=i.f}onDetails({_id:t}){return Object(c.a)(this,void 0,void 0,function*(){try{this.order=yield this.service.getOrder(t).toPromise(),this.order._id=t,this.status={orderStatus:this.order.orderStatus,paymentStatus:this.order.paymentStatus,paymentMethod:this.order.paymentMethod}}catch(e){console.log(e)}})}onUpdateStatus(){return Object(c.a)(this,void 0,void 0,function*(){try{this.order=yield this.service.updateStatus(this.order._id,this.status).toPromise()}catch(t){console.log(t)}})}}return t.\u0275fac=function(e){return new(e||t)(a.Ob(s.a))},t.\u0275cmp=a.Ib({type:t,selectors:[["app-search"]],decls:8,vars:1,consts:[[1,"container-fluid","component-head"],[1,"container-fluid"],[1,"row"],[1,"col-md-3"],[3,"pick"],["class","col-md-9",4,"ngIf"],[1,"col-md-9"],[3,"order","admin"],[1,"mt-3"],[1,"form-row","bg-white","m-1","p-2","mb-5","border"],[1,"form-group","col","m-0"],["for","orderStatus"],["id","orderStatus",1,"form-control","form-control-sm",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["for","paymentMethods"],["id","paymentMethods",1,"form-control","form-control-sm",3,"ngModel","ngModelChange"],["for","paymentStatus"],["id","paymentMethod",1,"form-control","form-control-sm",3,"ngModel","ngModelChange"],[1,"col-auto","d-flex","align-items-end"],[1,"btn","btn-sm","btn-primary",3,"click"],[3,"value"]],template:function(t,e){1&t&&(a.Tb(0,"div",0),a.Tb(1,"h3"),a.Ec(2,"Search Order"),a.Sb(),a.Sb(),a.Tb(3,"div",1),a.Tb(4,"div",2),a.Tb(5,"div",3),a.Tb(6,"app-order-side-search",4),a.dc("pick",function(t){return e.onDetails(t)}),a.Sb(),a.Sb(),a.Cc(7,F,23,8,"div",5),a.Sb(),a.Sb()),2&t&&(a.Ab(7),a.mc("ngIf",e.order))},directives:[x,l.o,v.a,d.s,d.l,d.o,l.n,d.p,d.u],styles:[""]}),t})();var U=r("LRne"),z=r("Kj3r"),G=r("/uUt"),D=r("eIep"),_=r("JIr8"),j=r("lJxs"),q=r("I/JT"),$=r("/7iW"),N=r("1kSV"),L=r("wOd6"),R=r("Ysqf");function V(t,e){if(1&t){const t=a.Ub();a.Tb(0,"div"),a.Tb(1,"div",11),a.Tb(2,"div",2),a.Tb(3,"div",3),a.Tb(4,"label",12),a.Ec(5),a.Sb(),a.Sb(),a.Tb(6,"div",5),a.Tb(7,"input",13),a.dc("selectItem",function(r){a.xc(t);const o=e.index;return a.fc().checkStock(o,r)}),a.Sb(),a.Sb(),a.Tb(8,"div",6),a.Tb(9,"label",12),a.Ec(10),a.Sb(),a.Sb(),a.Tb(11,"div",7),a.Tb(12,"input",14),a.dc("change",function(){return a.xc(t),a.fc().updateTotal()}),a.Sb(),a.Sb(),a.Tb(13,"div",6),a.Tb(14,"label",10),a.Ec(15),a.Sb(),a.Sb(),a.Tb(16,"div",3),a.Tb(17,"button",15),a.dc("click",function(){a.xc(t);const r=e.index;return a.fc().onRemoveItem(r)}),a.Pb(18,"i",16),a.Sb(),a.Sb(),a.Sb(),a.Sb(),a.Sb()}if(2&t){const t=e.index,r=a.fc();a.Ab(1),a.mc("formGroupName",t),a.Ab(4),a.Gc("",t+1," "),a.Ab(2),a.mc("ngbTypeahead",r.searchProduct)("editable",!1)("resultFormatter",r.productFormatter)("inputFormatter",r.productFormatter),a.Ab(3),a.Fc(r.parent.value.items[t].max_quantity),a.Ab(2),a.oc("placeholder","Quantity ",t+1,""),a.Ab(3),a.Fc(null!=r.parent.value.items[t].product&&r.parent.value.items[t].product.price?(null==r.parent.value.items[t].product?null:r.parent.value.items[t].product.price)*r.parent.value.items[t].quantity:0)}}let J=(()=>{class t{constructor(t,e){this.productService=t,this.stockService=e,this.removeItem=new a.o,this.total=0,this.searchProduct=t=>t.pipe(Object(z.a)(300),Object(G.a)(),Object(D.a)(t=>t.length<3?[]:this.productService.getList(new b.a(1,10,"name","asc",t)).pipe(Object(_.a)(()=>Object(U.a)([])))),Object(j.a)(t=>t?t.docs:[])),this.productFormatter=t=>{if(t)return`${t.name} - ${t.size}`}}onRemoveItem(t){this.removeItem.emit(t)}checkStock(t,e){return Object(c.a)(this,void 0,void 0,function*(){const r=this.parent.controls.items.at(t);try{const t=yield this.stockService.byProductId(e.item._id,new b.a(1,1e3)).toPromise();let o=0;t.forEach(t=>{o+=t.quantity}),r.controls.max_quantity.setValue(o)}catch(o){console.log(o.message),r.controls.max_quantity.setValue(0)}})}updateTotal(){const t=this.parent.get("items");let e=0;for(let r=0;r<t.length;r++)t.value[r].product&&(e+=t.value[r].quantity*t.value[r].product.price);this.total=e}}return t.\u0275fac=function(e){return new(e||t)(a.Ob(L.a),a.Ob(R.a))},t.\u0275cmp=a.Ib({type:t,selectors:[["order-item-form"]],inputs:{parent:"parent"},outputs:{removeItem:"removeItem"},decls:39,vars:3,consts:[[3,"formGroup"],["formArrayName","items"],[1,"form-row"],[1,"col-auto"],[1,"form-control","form-control-sm","border-0"],[1,"col"],[1,"col-1"],[1,"col-2"],[4,"ngFor","ngForOf"],[1,"col-1","text-right"],[1,"form-control","form-control-sm","text-right"],[3,"formGroupName"],[1,"form-control","form-control-sm"],["id","supplierId","type","text","formControlName","product","placeholder","Product name / barcode",1,"form-control","form-control-sm",3,"ngbTypeahead","editable","resultFormatter","inputFormatter","selectItem"],["type","number","formControlName","quantity","id","quantity",1,"form-control","form-control-sm",3,"placeholder","change"],[1,"btn","btn-sm","btn-danger",3,"click"],[1,"fa","fa-trash-o"]],template:function(t,e){1&t&&(a.Tb(0,"div",0),a.Tb(1,"div",1),a.Tb(2,"div",2),a.Tb(3,"div",3),a.Tb(4,"label",4),a.Tb(5,"strong"),a.Ec(6," # "),a.Sb(),a.Sb(),a.Sb(),a.Tb(7,"div",5),a.Tb(8,"label",4),a.Tb(9,"strong"),a.Ec(10,"Product "),a.Sb(),a.Sb(),a.Sb(),a.Tb(11,"div",6),a.Tb(12,"label",4),a.Tb(13,"strong"),a.Ec(14,"Max"),a.Sb(),a.Sb(),a.Sb(),a.Tb(15,"div",7),a.Tb(16,"label",4),a.Tb(17,"strong"),a.Ec(18,"Quantity"),a.Sb(),a.Sb(),a.Sb(),a.Tb(19,"div",6),a.Tb(20,"label",4),a.Tb(21,"strong"),a.Ec(22," Price"),a.Sb(),a.Sb(),a.Sb(),a.Tb(23,"div",3),a.Tb(24,"label",4),a.Ec(25,"\xa0"),a.Sb(),a.Sb(),a.Sb(),a.Cc(26,V,19,9,"div",8),a.Tb(27,"div",2),a.Tb(28,"div",5),a.Pb(29,"strong"),a.Sb(),a.Tb(30,"div",3),a.Tb(31,"strong"),a.Ec(32," Total"),a.Sb(),a.Sb(),a.Tb(33,"div",9),a.Tb(34,"label",10),a.Tb(35,"strong"),a.Ec(36),a.Sb(),a.Sb(),a.Sb(),a.Tb(37,"div",3),a.Ec(38," \xa0 \xa0 \xa0 \xa0 "),a.Sb(),a.Sb(),a.Sb(),a.Sb()),2&t&&(a.mc("formGroup",e.parent),a.Ab(26),a.mc("ngForOf",e.parent.controls.items.controls),a.Ab(10),a.Gc(" ",e.total,""))},directives:[d.m,d.f,d.b,l.n,d.g,d.a,N.m,d.l,d.e,d.q],styles:[""]}),t})();var X=r("Mhxx"),K=r("/ZIw");function B(t,e){if(1&t){const t=a.Ub();a.Tb(0,"div",21),a.Tb(1,"nav",22),a.Tb(2,"a",23),a.Ec(3,"Update profile of "),a.Tb(4,"strong"),a.Ec(5),a.Sb(),a.Sb(),a.Sb(),a.Tb(6,"div",24),a.Tb(7,"user-profile-form",25),a.dc("update",function(e){a.xc(t);const r=a.fc();return r.onUpdateProfile(r.user._id,e)})("close",function(){return e.$implicit.dismiss()}),a.Sb(),a.Sb(),a.Sb()}if(2&t){const t=a.fc();a.Ab(5),a.Fc(null==t.user?null:t.user.name),a.Ab(2),a.mc("item",t.user)}}function H(t,e){1&t&&(a.Tb(0,"small",26),a.Ec(1,"Customer Required"),a.Sb())}function Q(t,e){if(1&t&&(a.Tb(0,"div",27),a.Pb(1,"form-validator",28),a.Sb()),2&t){const t=a.fc();a.Ab(1),a.mc("form",t.form)}}let W=(()=>{class t extends q.a{constructor(t,e,r){super(),this.fb=t,this.userService=e,this.modalService=r,this.searchUser=t=>t.pipe(Object(z.a)(300),Object(G.a)(),Object(D.a)(t=>t.length<3?[]:this.userService.getList(new b.a(1,10,"name","asc",t)).pipe(Object(_.a)(()=>Object(U.a)([])))),Object(j.a)(t=>t?t.docs:[])),this.userFormatter=t=>{if(t)return`${t.name}  [${t.phone}]`},this.createForm()}createForm(){this.form=this.fb.group({customer:["",d.t.required],items:this.fb.array([this.createItemArray()])})}createItemArray(){return this.fb.group({product:["",d.t.required],quantity:[0,d.t.required],max_quantity:[""]})}onSelectCustomer(t,e){return Object(c.a)(this,void 0,void 0,function*(){try{this.user=yield this.userService.get(t.item._id).toPromise(),this.user.cus_add1&&this.user.cus_add1.length>2?this.form.patchValue({customer:this.user}):(this.form.patchValue({customer:""}),this.userProfileModal(e))}catch(r){}})}userProfileModal(t){this.modalService.open(t,{centered:!0,backdrop:"static",size:"md",scrollable:!0})}pushOrderItem(){this.form.get("items").push(this.createItemArray())}onRemoveOrderItem(t){this.form.get("items").removeAt(t)}onUpdateProfile(t,e){return Object(c.a)(this,void 0,void 0,function*(){this.modalService.dismissAll(),console.log(t),console.log(e);try{const r=yield this.userService.updateProfileByAdmin(t,e).toPromise();this.form.patchValue({customer:r})}catch(r){console.log(r.message)}})}}return t.\u0275fac=function(e){return new(e||t)(a.Ob(d.c),a.Ob($.a),a.Ob(N.i))},t.\u0275cmp=a.Ib({type:t,selectors:[["order-form"]],features:[a.xb],decls:28,vars:11,consts:[[1,"border","bg-white"],[1,"navbar","navbar-light","bg-light"],[1,"form-head"],["type","button","routerLink","/dashboard/orders",1,"btn","btn-primary","btn-sm"],[1,"fa","fa-list"],["userProfileModal",""],[1,"p-3",3,"formGroup","ngSubmit","mouseleave"],[1,"col-md-6"],["for","customer",1,"d-none","d-sm-block","col-form-label","col-form-label-sm","p-0"],["id","customer","type","text","formControlName","customer","placeholder","Customer name / phone",1,"form-control","form-control-sm",3,"ngbTypeahead","resultFormatter","inputFormatter","editable","selectItem"],["class","form-text text-danger",4,"ngIf"],[1,"row"],[1,"col-md-12","my-3"],[3,"parent","removeItem"],["type","button",1,"btn","btn-sm","btn-info",3,"click"],[1,"fa","fa-plus"],[1,"d-flex","flex-row-reverse","bd-highlight"],[3,"mouseenter"],["type","submit",1,"btn","btn-sm","btn-light","mx-1",3,"disabled"],["type","button",1,"btn","btn-sm","btn-light","mx-1",3,"click"],["class","text-danger",4,"ngIf"],[2,"min-height","400px"],[1,"navbar","navbar-light","bg-light","border","border-bottom-0"],[1,"navbar-brand"],[1,"border","rounded","bg-white","p-3"],[3,"item","update","close"],[1,"form-text","text-danger"],[1,"text-danger"],[3,"form"]],template:function(t,e){if(1&t){const t=a.Ub();a.Tb(0,"div",0),a.Tb(1,"div",1),a.Tb(2,"div",2),a.Ec(3),a.Sb(),a.Tb(4,"a",3),a.Pb(5,"i",4),a.Ec(6," Order List "),a.Sb(),a.Sb(),a.Cc(7,B,8,2,"ng-template",null,5,a.Dc),a.Tb(9,"form",6),a.dc("ngSubmit",function(){return e.submit()})("mouseleave",function(){return e.mouseoverShifting=!1}),a.Tb(10,"div",7),a.Tb(11,"label",8),a.Ec(12,"Customer*"),a.Sb(),a.Tb(13,"input",9),a.dc("selectItem",function(r){a.xc(t);const o=a.uc(8);return e.onSelectCustomer(r,o)}),a.Sb(),a.Cc(14,H,2,0,"small",10),a.Sb(),a.Tb(15,"div",11),a.Tb(16,"div",12),a.Tb(17,"order-item-form",13),a.dc("removeItem",function(t){return e.onRemoveOrderItem(t)}),a.Sb(),a.Tb(18,"button",14),a.dc("click",function(){return e.pushOrderItem()}),a.Pb(19,"i",15),a.Ec(20," Add Item "),a.Sb(),a.Sb(),a.Sb(),a.Tb(21,"div",16),a.Tb(22,"span",17),a.dc("mouseenter",function(){return e.mouseoverShifting=!0}),a.Tb(23,"button",18),a.Ec(24),a.Sb(),a.Sb(),a.Tb(25,"button",19),a.dc("click",function(){return e.clean()}),a.Ec(26,"Clear"),a.Sb(),a.Sb(),a.Cc(27,Q,2,1,"div",20),a.Sb(),a.Sb()}2&t&&(a.Ab(3),a.Gc(" ",e.exists?"Update":"New"," Order "),a.Ab(6),a.mc("formGroup",e.form),a.Ab(4),a.mc("ngbTypeahead",e.searchUser)("resultFormatter",e.userFormatter)("inputFormatter",e.userFormatter)("editable",!1),a.Ab(1),a.mc("ngIf",e.form.controls.customer.errors&&e.form.controls.customer.touched),a.Ab(3),a.mc("parent",e.form),a.Ab(6),a.mc("disabled",!e.form.valid),a.Ab(1),a.Fc(e.exists?"Update":"Save"),a.Ab(3),a.mc("ngIf",e.mouseoverShifting))},directives:[N.k,o.c,d.v,d.m,d.f,d.a,N.m,d.l,d.e,l.o,J,X.a,K.a],styles:[""]}),t})();var Z=r("HF3I");function Y(t,e){1&t&&a.Pb(0,"loading")}function tt(t,e){if(1&t){const t=a.Ub();a.Tb(0,"div",8),a.Tb(1,"strong"),a.Ec(2,"Success! "),a.Sb(),a.Ec(3),a.Tb(4,"button",9),a.dc("click",function(){return a.xc(t),a.fc().onClose()}),a.Tb(5,"span",10),a.Ec(6,"\xd7"),a.Sb(),a.Sb(),a.Sb()}if(2&t){const t=a.fc();a.Ab(3),a.Gc(" ",t.message," ")}}function et(t,e){if(1&t){const t=a.Ub();a.Tb(0,"div",11),a.Tb(1,"strong"),a.Ec(2,"Failed! "),a.Sb(),a.Ec(3),a.Tb(4,"button",9),a.dc("click",function(){return a.xc(t),a.fc().onClose()}),a.Tb(5,"span",10),a.Ec(6,"\xd7"),a.Sb(),a.Sb(),a.Sb()}if(2&t){const t=a.fc();a.Ab(3),a.Gc(" ",t.errMsg," ")}}const rt=[{path:"add",component:(()=>{class t{constructor(t,e){this.service=t,this.router=e,this.loading=!1,this.message="",this.errMsg=""}ngOnInit(){}onCreateOrder(t){return Object(c.a)(this,void 0,void 0,function*(){let e=[];t.items.forEach(t=>{e=[...e,{product:{barcode:t.product.barcode},quantity:t.quantity}]});const r={customer:{phone:t.customer.phone},items:e};try{yield this.service.create(r).toPromise(),this.router.navigateByUrl("/dashboard/orders")}catch(o){this.errMsg=o.message}})}onClose(){this.loading=!1,this.errMsg="",this.message=""}}return t.\u0275fac=function(e){return new(e||t)(a.Ob(s.a),a.Ob(o.b))},t.\u0275cmp=a.Ib({type:t,selectors:[["app-add"]],decls:10,vars:3,consts:[[1,"container-fluid","component-head"],[1,"container"],[4,"ngIf"],["class","alert alert-success alert-dismissible show","role","alert",4,"ngIf"],["class","alert alert-danger alert-dismissible show","role","alert",4,"ngIf"],[1,"row"],[1,"col-12","mb-5"],[3,"create"],["role","alert",1,"alert","alert-success","alert-dismissible","show"],["type","button",1,"close",3,"click"],["aria-hidden","true"],["role","alert",1,"alert","alert-danger","alert-dismissible","show"]],template:function(t,e){1&t&&(a.Tb(0,"div",0),a.Tb(1,"h3"),a.Ec(2,"Create Order"),a.Sb(),a.Sb(),a.Tb(3,"div",1),a.Cc(4,Y,1,0,"loading",2),a.Cc(5,tt,7,1,"div",3),a.Cc(6,et,7,1,"div",4),a.Tb(7,"div",5),a.Tb(8,"div",6),a.Tb(9,"order-form",7),a.dc("create",function(t){return e.onCreateOrder(t)}),a.Sb(),a.Sb(),a.Sb(),a.Sb()),2&t&&(a.Ab(4),a.mc("ngIf",e.loading),a.Ab(1),a.mc("ngIf",e.message.length>0),a.Ab(1),a.mc("ngIf",e.errMsg.length>0))},directives:[l.o,W,Z.a],styles:["[_nghost-%COMP%]{font-size:14px;font-family:Montserrat,sans-serif;display:block;position:relative;min-height:calc(100% - 57px);background-color:#f2f4f5}"]}),t})()},{path:"search",component:w},{path:"",component:C}];let ot=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=a.Mb({type:t}),t.\u0275inj=a.Lb({imports:[[n.a,o.d.forChild(rt)]]}),t})()},uEz7:function(t,e,r){"use strict";r.d(e,"a",function(){return d});var o=r("fXoL"),n=r("ofXK"),c=r("tyNb");const i=function(t){return{disabled:t}};function a(t,e){if(1&t){const t=o.Ub();o.Tb(0,"li",4),o.Tb(1,"a",5),o.dc("click",function(){return o.xc(t),o.fc().onPaginate(1)}),o.Ec(2),o.Sb(),o.Sb()}if(2&t){const t=o.fc();o.mc("ngClass",o.qc(2,i,1===t.page)),o.Ab(2),o.Gc(" ",1==t.short?"<<":"First"," ")}}const s=function(t){return{current:t}};function b(t,e){if(1&t){const t=o.Ub();o.Tb(0,"li",4),o.Tb(1,"a",5),o.dc("click",function(){o.xc(t);const r=e.$implicit;return o.fc().onPaginate(r)}),o.Ec(2),o.Sb(),o.Sb()}if(2&t){const t=e.$implicit,r=o.fc();o.mc("ngClass",o.qc(2,s,r.page==t)),o.Ab(2),o.Gc(" ",t," ")}}function l(t,e){if(1&t){const t=o.Ub();o.Tb(0,"li",4),o.Tb(1,"a",5),o.dc("click",function(){o.xc(t);const e=o.fc();return e.onPaginate(e.pageCount)}),o.Ec(2),o.Sb(),o.Sb()}if(2&t){const t=o.fc();o.mc("ngClass",o.qc(2,i,t.page===t.pageCount)),o.Ab(2),o.Gc(" ",1==t.short?">>":"Last"," ")}}let d=(()=>{class t{constructor(){this.short=!1,this.collectionSize=1,this.pageSize=1,this.page=1,this.pageChange=new o.o,this.pageCount=1}ngOnChanges(t){this.pageCount=Math.ceil(this.collectionSize/this.pageSize)}onPaginate(t){this.pageChange.emit(t)}counter(t,e){let r=1,o=10;return e<10?o=e:r=t<5?1:t+5>=e?e-9:t-4,Array.from({length:o},(t,e)=>e+r)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=o.Ib({type:t,selectors:[["pagination"]],inputs:{short:"short",collectionSize:"collectionSize",pageSize:"pageSize",page:"page"},outputs:{pageChange:"pageChange"},features:[o.yb],decls:12,vars:11,consts:[[1,"text-center"],["aria-label","Page navigation"],[1,"pagination","mb-0"],["class","page-item",3,"ngClass",4,"ngIf"],[1,"page-item",3,"ngClass"],[1,"page-link",3,"routerLink","click"],["class","page-item",3,"ngClass",4,"ngFor","ngForOf"]],template:function(t,e){1&t&&(o.Tb(0,"div",0),o.Tb(1,"nav",1),o.Tb(2,"ul",2),o.Cc(3,a,3,4,"li",3),o.Tb(4,"li",4),o.Tb(5,"a",5),o.dc("click",function(){return e.onPaginate(e.page-1)}),o.Ec(6),o.Sb(),o.Sb(),o.Cc(7,b,3,4,"li",6),o.Tb(8,"li",4),o.Tb(9,"a",5),o.dc("click",function(){return e.onPaginate(e.page+1)}),o.Ec(10),o.Sb(),o.Sb(),o.Cc(11,l,3,4,"li",3),o.Sb(),o.Sb(),o.Sb()),2&t&&(o.Ab(3),o.mc("ngIf",!e.short),o.Ab(1),o.mc("ngClass",o.qc(7,i,1===e.page)),o.Ab(2),o.Gc(" ",1==e.short?"<":"Previous"," "),o.Ab(1),o.mc("ngForOf",e.counter(e.page,e.pageCount)),o.Ab(1),o.mc("ngClass",o.qc(9,i,e.page===e.pageCount)),o.Ab(2),o.Gc(" ",1==e.short?">":"Next"," "),o.Ab(1),o.mc("ngIf",!e.short))},directives:[n.o,n.m,c.c,n.n],styles:[".current[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{background-color:#dee2e6;font-weight:600;color:#000}.page-link[_ngcontent-%COMP%]{padding:.2rem .4rem}"]}),t})()}}]);